<!DOCTYPE html>
<!--
  ‰Ωø„ÅÑÊñπ (Usage)
  - ÈÄöÂ∏∏„É¢„Éº„Éâ: index.html „Çí„Åù„ÅÆ„Åæ„ÅæÈñã„ÅèÔºà„ÇØ„Ç®„É™„Å™„ÅóÔºâ
  - „Éè„Éº„Éâ„É¢„Éº„Éâ: URL „Å´ ?hardÔºà‰æã: ?hard, ?hard=1, ?hard=true, ?hard=onÔºâ
    „ÉªË™§Á≠î„Åó„Å¶ 0Áï™„Å´Êàª„Å£„ÅüÁõ¥Âæå„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏: ‰Ωï„ÇÇË°®Á§∫„Åó„Åæ„Åõ„Çì
  - „ÇΩ„Éï„Éà„É¢„Éº„ÉâÔºö URL „Å´ ?softÔºà‰æã: ?soft, ?soft=1, ?soft=true, ?soft=onÔºâ
    „ÉªÊ≠£Ëß£„Åó„Å¶ÂÖà„Å∏ÈÄ≤„Çì„Å†Â†¥Âêà„Åß„ÇÇ„ÄÅÂâçÂõû„ÅÆÁï∞Â§â„Çí #message „Å´Ë°®Á§∫„Åó„Åæ„Åô
  - ÈÄöÂ∏∏„É¢„Éº„ÉâÊôÇ„ÅÆ‰ªïÊßò:
    „ÉªË™§Á≠î„Åó„Å¶ 0Áï™„Å´Êàª„Å£„ÅüÁõ¥Âæå„Å´„ÄÅÂéüÂõ†ÔºàË¶ãÈÄÉ„Åó/Ë™§Â†±Ôºâ„Çí #message „Å´Ë°®Á§∫„Åó„Åæ„Åô
  - „Éá„Éê„ÉÉ„Ç∞Ë°®Á§∫: URL „Å´ ?debugÔºà‰æã: ?debug, ?debug=1Ôºâ„Åß„Éá„Éê„ÉÉ„Ç∞ UI „ÇíË°®Á§∫
  - „Ç≤„Éº„É†„ÅÆËµ∑Âãï„ÅØ„ÄÅ„Éñ„É©„Ç¶„Ç∂„Åß„Éï„Ç°„Ç§„É´„ÇíÈñã„ÅèÔºà‰æã: file:///index.html„ÄÅ„ÇÇ„Åó„Åè„ÅØ„Éï„Ç°„Ç§„É´„ÇídÔºÜd„Åô„ÇãÔºâ
-->
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÔºòÁï™ÈÄöË∑Ø</title>
    <style>
        /* --- Google Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Orbitron:wght@400;700&display=swap');

        /* --- Âü∫Êú¨Ë®≠ÂÆö --- */
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --container-bg: rgba(30, 30, 30, 0.9);
            --border-color: #444;
            --title-color: #e53935;
            --message-color: #ffd700;
            --normal-light-color: #f0f0c0;
            --normal-sign-bg: #004d40;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Meiryo', 'Hiragino Kaku Gothic ProN', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            transition: background-color 1s ease, filter 1s ease;
        }

        .game-wrapper {
            position: relative;
            max-width: 800px;
            width: 90%;
            padding: 40px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--container-bg);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            text-align: center;
            z-index: 2;
            overflow: hidden;
            transition: border-color 0.5s ease, border-radius 0.5s, background-color 0.5s, transform 0.5s, box-shadow 0.5s;
        }

        /* --- Ë¶ñË¶öÁöÑ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà --- */
        .ceiling-light {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) perspective(100px) rotateX(45deg);
            width: 50%;
            height: 40px;
            background: linear-gradient(#222, #333);
            border: 2px solid #111;
            transition: width 0.5s, border-radius 0.5s;
        }

        .ceiling-light::after {
            content: '';
            display: block;
            width: 90%;
            height: 80%;
            margin: 5% auto;
            background-color: var(--normal-light-color);
            box-shadow: 0 0 15px 5px var(--normal-light-color);
            transition: background-color 0.5s, box-shadow 0.5s, animation-duration 0.5s;
            animation: light-hum 7s infinite alternate ease-in-out;
        }

        @keyframes light-hum {
            from {
                opacity: 0.95;
            }

            to {
                opacity: 1;
            }
        }

        .wall-sign {
            position: absolute;
            top: 40%;
            right: -20px;
            transform: translateY(-50%) perspective(200px) rotateY(-30deg);
            width: 100px;
            height: 150px;
            background-color: var(--normal-sign-bg);
            border: 5px solid #ccc;
            border-radius: 5px;
            box-shadow: -5px 5px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.5s, background-color 0.5s, box-shadow 0.5s, opacity 0.5s, border-style 0.5s;
        }

        .wall-sign::before {
            content: 'ÈùûÂ∏∏Âè£';
            color: white;
            font-size: 24px;
            font-weight: bold;
            writing-mode: vertical-rl;
            text-orientation: upright;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: content 0.3s, font-family 0.3s, color 0.3s;
        }

        .poster {
            position: absolute;
            top: 50%;
            left: -10px;
            transform: translateY(-50%) perspective(200px) rotateY(25deg);
            width: 90px;
            height: 130px;
            background-color: #f0ead6;
            border: 3px solid #333;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.5s, background-color 0.5s, opacity 0.5s;
        }

        .poster::before {
            content: 'ÂÆâÂÖ®Á¨¨‰∏Ä';
            color: #333;
            font-size: 20px;
            font-weight: bold;
            writing-mode: vertical-rl;
            text-orientation: upright;
            white-space: nowrap;
            line-height: 1;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            transition: content 0.3s;
        }

        .floor {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 25%;
            z-index: -1;
            background:
                linear-gradient(rgba(30, 30, 30, 0.9), rgba(30, 30, 30, 0.2)),
                repeating-linear-gradient(45deg, #444, #444 10px, #555 10px, #555 20px);
            transition: background 0.5s;
        }

        /* --- UIË¶ÅÁ¥† --- */
        h1 {
            color: var(--title-color);
            font-family: 'Orbitron', sans-serif;
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(229, 57, 53, 0.7);
            transition: font-weight 0.5s, color 0.5s, text-shadow 0.5s;
        }

        #description {
            font-size: 1.2em;
            line-height: 1.8;
            min-height: 150px;
            white-space: pre-wrap;
            margin-bottom: 30px;
            transition: color 0.5s, font-family 0.8s, letter-spacing 0.5s, text-align 0.5s, transform 0.5s;
        }

        .buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            transition: flex-direction 0.5s;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2em;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50;
            color: white;
            transition: background-color 0.3s, transform 0.1s, opacity 0.3s, color 0.3s, box-shadow 0.3s, border-radius 0.3s;
        }

        button:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        button:hover:not(:disabled) {
            background-color: #45a049;
        }

        button:active:not(:disabled) {
            transform: scale(0.98);
        }

        #back-button {
            background-color: #f44336;
        }

        #back-button:hover:not(:disabled) {
            background-color: #da190b;
        }

        #message {
            margin-top: 20px;
            font-size: 1.2em;
            color: var(--message-color);
            font-weight: bold;
            height: 30px;
            transition: opacity 0.5s, color 0.5s, border 0.5s;
            box-sizing: border-box;
        }

        /* --- ÊöóËª¢Áî®„Ç™„Éº„Éê„Éº„É¨„Ç§ --- */
        #fade-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            opacity: 0;
            z-index: 9999;
            pointer-events: none;
            transition: opacity 1s ease-in-out;
        }

        #fade-overlay.is-active {
            opacity: 1;
            pointer-events: auto;
        }

        /* --- Áï∞Â§âÈÅ©Áî®ÊôÇ„ÅØ„Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥„ÇíÊäëÊ≠¢ÔºàË¶ãÁ†¥„ÇäÈò≤Ê≠¢Ôºâ --- */
        #game-wrapper.no-transition,
        #game-wrapper.no-transition * {
            transition: none !important;
        }

        body.no-transition-filter {
            transition: none !important;
        }

        /* --- ËøΩÂä†„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà --- */
        .puddle {
            position: absolute;
            bottom: 5%;
            left: 50%;
            width: 100px;
            height: 30px;
            background: rgba(80, 120, 150, 0.3);
            border-radius: 50%;
            transform: translateX(-50%) perspective(50px) rotateX(60deg);
            box-shadow: 0 0 10px rgba(80, 120, 150, 0.5);
            display: none;
        }

        .anomaly-puddle .puddle {
            display: block;
        }

        .crack {
            position: absolute;
            top: 20%;
            left: 10%;
            width: 5px;
            height: 150px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            transform: rotate(20deg);
            display: none;
        }

        .crack::after {
            content: '';
            position: absolute;
            top: 50px;
            left: -30px;
            width: 3px;
            height: 80px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 50%;
            transform: rotate(-40deg);
        }

        .anomaly-crack .crack {
            display: block;
        }

        /* --- „Éá„Éê„ÉÉ„Ç∞„É¢„Éº„ÉâÁî®„Çπ„Çø„Ç§„É´ --- */
        #debug-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: #0f0;
            padding: 15px;
            border: 1px solid #0f0;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.6;
            z-index: 10000;
            text-align: left;
            display: none;
        }

        #debug-info h3 {
            margin: 0 0 10px 0;
            padding-bottom: 5px;
            border-bottom: 1px solid #0f0;
            color: #0f0;
        }

        #debug-info select,
        #debug-info button {
            margin-top: 10px;
            width: 100%;
        }

        /* --- Áï∞Â§â„ÅÆ„Çπ„Çø„Ç§„É´ --- */
        .anomaly-light-red .ceiling-light::after {
            background-color: #ff4d4d;
            box-shadow: 0 0 20px 10px #ff4d4d;
        }

        .anomaly-light-flicker .ceiling-light::after {
            animation: flicker 0.3s infinite alternate;
        }

        @keyframes flicker {
            0% {
                opacity: 1;
            }

            40% {
                opacity: 0.3;
            }

            100% {
                opacity: 0.8;
            }
        }

        .anomaly-light-off .ceiling-light::after {
            background-color: #333;
            box-shadow: none;
        }

        .anomaly-light-green .ceiling-light::after {
            background-color: #4caf50;
            box-shadow: 0 0 20px 10px #4caf50;
        }

        .anomaly-light-narrow .ceiling-light {
            width: 40%;
        }

        .anomaly-sign-crooked .wall-sign {
            transform: translateY(-50%) perspective(200px) rotateY(-30deg) rotateZ(-15deg);
        }

        .anomaly-sign-garbled .wall-sign::before {
            font-family: 'MS Mincho';
        }

        .anomaly-sign-shadow .wall-sign {
            box-shadow: -5px 5px 15px rgba(200, 0, 0, 0.5);
        }

        .anomaly-sign-blue .wall-sign {
            background-color: #1565c0;
        }

        .anomaly-sign-missing .wall-sign {
            opacity: 0;
        }

        .anomaly-sign-text-changed .wall-sign::before {
            content: 'ÂÖ•Âè£';
        }

        .anomaly-sign-dashed .wall-sign {
            border-style: dashed;
        }

        .anomaly-sign-text-yellow .wall-sign::before {
            color: yellow;
        }

        .anomaly-font-creepy #description {
            font-family: 'Noto Serif JP', serif;
            color: #bbb;
        }

        .anomaly-shake {
            animation: shake 5s infinite linear;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            10%,
            30%,
            50%,
            70%,
            90% {
                transform: translateX(-4px);
            }

            20%,
            40%,
            60%,
            80% {
                transform: translateX(4px);
            }
        }

        .anomaly-letter-spacing #description {
            letter-spacing: 0.1em;
        }

        .anomaly-title-weight h1 {
            font-weight: 400;
        }

        .anomaly-text-align-justify #description {
            text-align: justify;
        }

        .anomaly-border-radius {
            border-radius: 50px;
        }

        .anomaly-buttons-swapped .buttons {
            flex-direction: row-reverse;
        }

        .anomaly-text-color-strong {
            color: #f06292 !important;
        }

        .anomaly-title-color-strong {
            color: #ff5722 !important;
        }

        .anomaly-border-color-strong {
            border-color: #6a1b9a !important;
        }

        .anomaly-bg-strong {
            background-color: #0d47a1 !important;
        }

        .anomaly-wrapper-bg-strong {
            background-color: rgba(70, 20, 20, 0.9) !important;
        }

        .anomaly-puddle-green .puddle {
            display: block;
            background: rgba(50, 150, 50, 0.5);
            box-shadow: 0 0 15px rgba(50, 150, 50, 0.7);
        }

        .anomaly-crack-red .crack,
        .anomaly-crack-red .crack::after {
            display: block;
            background: rgba(255, 0, 0, 0.5);
        }

        .anomaly-floor-yellow .floor {
            background: linear-gradient(rgba(30, 30, 30, 0.9), rgba(30, 30, 30, 0.2)), repeating-linear-gradient(45deg, #FFD700, #FFD700 10px, #FFC107 10px, #FFC107 20px);
        }

        .anomaly-border-color-green {
            border-color: #4caf50 !important;
        }

        .anomaly-border-color-blue {
            border-color: #2196f3 !important;
        }

        .anomaly-floor-red .floor {
            background: linear-gradient(rgba(30, 30, 30, 0.2), rgba(30, 30, 30, 0.1)), repeating-linear-gradient(45deg, #b71c1c, #b71c1c 10px, #c62828 10px, #c62828 20px);
        }

        .anomaly-floor-blue .floor {
            background: linear-gradient(rgba(30, 30, 30, 0.2), rgba(30, 30, 30, 0.1)), repeating-linear-gradient(90deg, #1a237e, #1a237e 10px, #283593 10px, #283593 20px);
        }

        .anomaly-poster-upside-down .poster {
            transform: translateY(-50%) perspective(200px) rotateY(25deg) rotateZ(180deg);
        }

        .anomaly-poster-text-garbled .poster::before {
            content: '‚ñ†‚ñ†‚ñ†‚ñ†';
        }

        /* Mirror text on the right exit sign */
        .anomaly-sign-text-mirrored .wall-sign::before {
            transform: translate(-50%, -50%) scaleX(-1);
        }

        /* Mirror text on the left poster */
        .anomaly-poster-text-mirrored .poster::before {
            transform: translate(-50%, -50%) scaleX(-1);
        }

        .anomaly-sign-open .wall-sign {
            transform: translateY(-50%) perspective(200px) rotateY(-70deg);
        }

        .anomaly-sign-open .wall-sign::before {
            content: '';
        }

        .anomaly-sign-open .wall-sign::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
        }

        .anomaly-sign-peeking .wall-sign::after {
            content: 'üëÄ';
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 30px;
        }

        .anomaly-buttons-black-text button {
            color: #000;
        }

        .anomaly-poster-missing .poster {
            opacity: 0;
        }

        .anomaly-poster-text-changed .poster::before {
            content: 'Âç±Èô∫';
        }

        .anomaly-poster-color-changed .poster {
            background-color: #add8e6;
        }

        /* Poster size variations */
        .anomaly-poster-bigger .poster {
            transform: translateY(-50%) perspective(200px) rotateY(25deg) scale(1.3);
        }

        .anomaly-poster-smaller .poster {
            transform: translateY(-50%) perspective(200px) rotateY(25deg) scale(0.7);
        }

        /* Eye on the poster (peeking style, same as sign) */
        .anomaly-poster-eye .poster::after {
            content: 'üëÄ';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 40px;
            filter: drop-shadow(0 0 6px rgba(0, 0, 0, 0.7));
        }

        .anomaly-text-upside-down #description {
            transform: rotate(180deg);
        }

        .anomaly-text-mirrored #description {
            transform: scaleX(-1);
        }

        .anomaly-floor-angle-changed .floor {
            background: linear-gradient(rgba(30, 30, 30, 0.9), rgba(30, 30, 30, 0.2)), repeating-linear-gradient(135deg, #444, #444 10px, #555 10px, #555 20px);
        }

        .anomaly-puddle-red .puddle {
            display: block;
            background: rgba(150, 50, 50, 0.5);
            box-shadow: 0 0 15px rgba(150, 50, 50, 0.7);
        }

        .anomaly-title-shadow-green h1 {
            text-shadow: 0 0 15px #0f0;
        }

        .anomaly-buttons-glow button {
            box-shadow: 0 0 15px #fff;
        }


        .anomaly-wrapper-rotated {
            transform: rotate(-2deg);
        }

        .anomaly-message-border #message {
            border: 1px solid var(--message-color);
        }

        /* removed: fast flicker anomaly per request */

        .anomaly-buttons-square button {
            border-radius: 0;
        }

        /* --- Added anomalies (request) --- */
        /* 2. Forward button label becomes imperative "ÈÄ≤„ÇÅ" */
        .anomaly-forward-imperative #forward-button {
            position: relative;
            color: transparent;
        }

        .anomaly-forward-imperative #forward-button::after {
            content: 'ÈÄ≤„ÇÅ';
            position: absolute;
            inset: 0;
            display: grid;
            place-items: center;
            color: #fff;
        }

        /* 3. Back button label becomes imperative "Êàª„Çå" */
        .anomaly-back-imperative #back-button {
            position: relative;
            color: transparent;
        }

        .anomaly-back-imperative #back-button::after {
            content: 'Êàª„Çå';
            position: absolute;
            inset: 0;
            display: grid;
            place-items: center;
            color: #fff;
        }

        /* 4. Panties at bottom-right */
        #game-wrapper.anomaly-panties-br::after {
            content: 'ü©≤';
            position: absolute;
            right: 8px;
            bottom: 6px;
            font-size: 28px;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.6));
            pointer-events: none;
        }

        /* 5. Trunks at bottom-left */
        #game-wrapper.anomaly-trunks-bl::before {
            content: 'ü©≥';
            position: absolute;
            left: 8px;
            bottom: 6px;
            font-size: 28px;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.6));
            pointer-events: none;
        }

        /* 6. Poster text "ÂÆâÂÖ®Âºü‰∏Ä" */
        .anomaly-poster-safety-brother .poster::before {
            content: 'ÂÆâÂÖ®Âºü‰∏Ä';
        }

        /* 7. (Removed) Message ellipsis color black ‚Äî deleted per request */

        /* 8. Exit sign position higher/lower */
        .anomaly-sign-higher .wall-sign {
            top: 30%;
        }

        .anomaly-sign-lower .wall-sign {
            top: 50%;
        }

        /* 9. Poster position higher/lower */
        .anomaly-poster-higher .poster {
            top: 40%;
        }

        .anomaly-poster-lower .poster {
            top: 60%;
        }

        /* 10. Passage title slightly lower */
        .anomaly-passage-title-lower #passage-title {
            transform: translateY(8px);
        }

        /* 11. Ceiling light stronger blur */
        .anomaly-light-blur-stronger .ceiling-light::after {
            box-shadow: 0 0 22px 8px var(--normal-light-color);
        }

        /* 12. Buttons avoid cursor (JS-driven; optional easing here) */
        .anomaly-buttons-avoid-cursor .buttons button {
            will-change: transform;
        }

        /* New: cursor appears faint (light, semi-transparent) */
        .anomaly-cursor-faint#game-wrapper,
        .anomaly-cursor-faint#game-wrapper * {
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='16' height='16'><circle cx='8' cy='8' r='6' fill='%23fff' fill-opacity='0.35' stroke='%23fff' stroke-opacity='0.35'/></svg>") 8 8, default;
        }

        /* New: dim the game when cursor leaves wrapper (active only when anomaly on) */
        .anomaly-dim-on-leave#game-wrapper.is-dimmed {
            filter: brightness(0.6) contrast(0.95);
        }

        /* New: cursor trail dots */
        .anomaly-cursor-trail .cursor-trail-dot {
            position: absolute;
            left: 0;
            top: 0;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.35);
            transform: translate(-50%, -50%) scale(1);
            pointer-events: none;
            filter: blur(0.4px);
            animation: trailFade 0.6s ease-out forwards;
            z-index: 5;
        }

        @keyframes trailFade {
            from {
                opacity: 0.35;
                transform: translate(-50%, -50%) scale(1);
            }

            to {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1.8);
            }
        }

        body.anomaly-body-grayscale {
            filter: grayscale(100%);
        }

        body.anomaly-body-sepia {
            filter: sepia(100%);
        }

        body.anomaly-body-invert {
            filter: invert(100%);
        }

        body.anomaly-body-hue-rotate {
            filter: hue-rotate(180deg);
        }

        body.anomaly-body-blur {
            filter: blur(3px);
        }

        body.anomaly-body-contrast {
            filter: contrast(200%);
        }

        /* Background silhouette (bring above wrapper for visibility) */
        body.anomaly-body-silhouette::before {
            content: 'üë§';
            position: fixed;
            left: 50%;
            top: 35%;
            transform: translate(-50%, -50%);
            font-size: 220px;
            color: rgba(255, 255, 255, 0.18);
            text-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            z-index: 3;
            /* above wrapper (z-index:2), below fade/debug */
        }

        /* Body anomaly: small heart at browser top-left */
        body.anomaly-body-heart-topleft::before {
            content: '‚ù§';
            position: fixed;
            top: 8px;
            left: 10px;
            font-size: 22px;
            color: #ff5a77;
            text-shadow: 0 0 6px rgba(0, 0, 0, 0.35);
            pointer-events: none;
            z-index: 10000;
            /* ensure above UI */
            animation: heartPulse 1.6s ease-in-out infinite;
        }

        @keyframes heartPulse {
            from {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            to {
                transform: scale(1);
            }
        }
    </style>
</head>

<body>

    <div id="fade-overlay"></div>
    <div id="debug-info"></div>

    <div class="game-wrapper" id="game-wrapper">
        <div class="ceiling-light"></div>
        <div class="wall-sign"></div>
        <div class="poster"></div>
        <div class="floor"></div>
        <div class="puddle"></div>
        <div class="crack"></div>
        <h1 id="passage-title">0Áï™ÈÄöË∑Ø</h1>
        <p id="description"></p>
        <div class="buttons">
            <button id="forward-button">ÈÄ≤„ÇÄ</button>
            <button id="back-button">Êàª„Çã</button>
        </div>
        <p id="message"></p>
    </div>

    <script>
        const wrapper = document.getElementById('game-wrapper');
        const passageTitle = document.getElementById('passage-title');
        const description = document.getElementById('description');
        const forwardButton = document.getElementById('forward-button');
        const backButton = document.getElementById('back-button');
        const message = document.getElementById('message');
        const fadeOverlay = document.getElementById('fade-overlay');
        const bodyEl = document.body;
        const debugInfo = document.getElementById('debug-info');
        // --- For anomaly #12: buttons avoid cursor ---
        let avoidCursorActive = false;
        const buttons = () => Array.from(wrapper.querySelectorAll('.buttons button'));
        function resetButtonTransforms() {
            buttons().forEach(btn => { btn.style.transform = ''; });
        }
        function handleMouseMoveAvoid(e) {
            if (!avoidCursorActive) return;
            const mx = e.clientX;
            const my = e.clientY;
            const maxRadius = 120; // proximity radius
            const maxPush = 18;    // max px to push away
            buttons().forEach(btn => {
                const rect = btn.getBoundingClientRect();
                const cx = rect.left + rect.width / 2;
                const cy = rect.top + rect.height / 2;
                const dx = cx - mx;
                const dy = cy - my;
                const dist = Math.hypot(dx, dy) || 1;
                if (dist < maxRadius) {
                    const scale = (1 - dist / maxRadius);
                    const mag = maxPush * scale;
                    const nx = dx / dist;
                    const ny = dy / dist;
                    const tx = nx * mag;
                    const ty = ny * mag;
                    btn.style.transform = `translate(${tx.toFixed(1)}px, ${ty.toFixed(1)}px)`;
                } else {
                    btn.style.transform = '';
                }
            });
        }
        wrapper.addEventListener('mousemove', handleMouseMoveAvoid);
        wrapper.addEventListener('mouseleave', resetButtonTransforms);
        // --- For anomaly: dim screen when cursor leaves ---
        let dimOnLeaveActive = false;
        wrapper.addEventListener('mouseenter', () => {
            if (dimOnLeaveActive) wrapper.classList.remove('is-dimmed');
        });
        wrapper.addEventListener('mouseleave', () => {
            if (dimOnLeaveActive) wrapper.classList.add('is-dimmed');
        });
        // --- For anomaly: cursor trail ---
        let cursorTrailActive = false;
        function spawnCursorTrailDot(x, y) {
            const dot = document.createElement('div');
            dot.className = 'cursor-trail-dot';
            dot.style.left = `${x}px`;
            dot.style.top = `${y}px`;
            wrapper.appendChild(dot);
            // Remove after animation
            setTimeout(() => dot.remove(), 650);
        }
        function handleMouseMoveTrail(e) {
            if (!cursorTrailActive) return;
            const rect = wrapper.getBoundingClientRect();
            spawnCursorTrailDot(e.clientX - rect.left, e.clientY - rect.top);
        }
        wrapper.addEventListener('mousemove', handleMouseMoveTrail);
        // --- For anomaly: URL bar shows "„Åå„Çì„Å∞„Çå„Éº" ---
        let urlGanbareActive = false;
        const originalURLHash = location.hash;

        let currentPassage = 0;
        let hasAnomaly = false;
        let currentAnomaly = {};
        let isFirstTurn = true;
        let isDebugMode = false;
        let shuffledAnomalies = [];
        let originalAnomalies = [];
        // Hard mode toggle from URL and pending message store
        let isHardMode = false;
        let isSoftMode = false;
        let pendingReturnMessage = '';
        let pendingProceedMessage = '';

        // Enable debug if the param is truthy or present
        function isDebugEnabledFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (!params.has('debug')) return false;
            const raw = params.get('debug');
            if (raw === null) return true;
            const v = String(raw).toLowerCase();
            return v === '' || v === 'true' || v === '1' || v === 'on' || v === 'yes' || v === 'y' || v === 't' || v === 'ture';
        }

        // Enable hard mode if the param is truthy or present
        function isHardModeEnabledFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (!params.has('hard')) return false;
            const raw = params.get('hard');
            if (raw === null) return true;
            const v = String(raw).toLowerCase();
            return v === '' || v === 'true' || v === '1' || v === 'on' || v === 'yes' || v === 'y' || v === 't' || v === 'ture';
        }

        // Enable soft mode if the param is truthy or present
        function isSoftModeEnabledFromURL() {
            const params = new URLSearchParams(window.location.search);
            if (!params.has('soft')) return false;
            const raw = params.get('soft');
            if (raw === null) return true;
            const v = String(raw).toLowerCase();
            return v === '' || v === 'true' || v === '1' || v === 'on' || v === 'yes' || v === 'y' || v === 't' || v === 'ture';
        }

        const normalDescription = "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ";

        const anomalies = [
            // „ÉÜ„Ç≠„Çπ„ÉàÁï∞Â§â
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã,", class: '', hint: 'ÊñáÊú´„Åå„Äå„ÄÅ„Äç„Å´„Å™„Å£„Å¶„ÅÑ„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„Äå„Ç∏„Éº‚Ä¶„Äç„ÅÆ„Äå‚Ä¶„Äç„Åå„Å™„Åã„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä•„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '‰∏âÁÇπ„É™„Éº„ÉÄ„Éº„Äå‚Ä¶„Äç„Åå‰∫åÁÇπ„Äå‚Ä•„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„ÇãÔºÅ", class: '', hint: 'ÊñáÊú´„Åå„ÄåÔºÅ„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã?", class: '', hint: 'ÊñáÊú´„Åå„ÄåÔºü„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ„ÄÇ", class: '', hint: 'Âè•ÁÇπ„Åå2„Å§„ÅÇ„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„ÇãÔºé\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†Ôºé\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„ÇãÔºé", class: '', hint: 'Âè•ÁÇπ„ÅåÂÖ®Ëßí„Éî„É™„Ç™„Éâ„ÄåÔºé„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\n\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'ÊñáÁ´†„ÅÆÈñì„Åå‰∏ÄË°åÁ©∫„ÅÑ„Å¶„ÅÑ„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„Çí„Åü„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÁ´ã„Å¶„Å¶„Äç„Åå„Å≤„Çâ„Åå„Å™„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËû¢ÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåËõçÂÖâÁÅØ„Äç„ÅÆÊº¢Â≠ó„ÅåÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÁíß„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÂ£Å„Äç„ÅÆÊº¢Â≠ó„ÅåÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å§„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÂÖâ„Å£„Å¶„ÅÑ„Çã„Äç„ÅÆ„Äå„Å£„Äç„Åå„Å™„Åã„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£Êîæ„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„Äå„Å±„Å™„Åó„Äç„ÅÆË°®Ë®ò„ÅåÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®Ë®Ä„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„Äå„Å®„ÅÑ„ÅÜ„Äç„ÅåÊº¢Â≠ó„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∑„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'Êì¨Èü≥„Åå„Äå„Ç∑„Éº‚Ä¶„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâìÊîæ„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÊâì„Å°„Å£„Å±„Å™„Åó„Äç„ÅÆË°®Ë®ò„ÅåÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´Â±Ö„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„Äå„ÅÑ„Çã„Äç„ÅåÊº¢Â≠ó„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèËºù„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÂÖâ„Å£„Å¶„ÅÑ„Çã„Äç„Åå„ÄåËºù„ÅÑ„Å¶„ÅÑ„Çã„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØË≥™Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÁ∞°Á¥†„Å™„Äç„Åå„ÄåË≥™Á¥†„Å™„Äç„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„Éà„ÅÜ„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÊâì„Å°„Å£„Å±„Å™„Åó„Äç„Åå„Å≤„Çâ„Åå„Å™„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜ„Åä„Å®„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÈü≥„Äç„Åå„Å≤„Çâ„Åå„Å™„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„Åè„Å≤„Åã„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÂÖâ„Å£„Å¶„ÅÑ„Çã„Äç„Åå„Å≤„Çâ„Åå„Å™„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÉèÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„Éè„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÉéËõçÂÖâÁÅØ„Ç¨„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„É≤Á´ã„Å¶„Å¶ÁôΩ„ÇØÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'Âä©Ë©û„Åå„Ç´„Çø„Ç´„Éä„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„Éà„ÅÆÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'ÊñáÁ´†„ÅÆÊßãÊàê„ÅåÂ∞ë„ÅóÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶Ëµ§„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÉÜ„Ç≠„Çπ„Éà„Åß„ÄåËµ§„Åè„Äç„Å®Êõ∏„Åã„Çå„Å¶„ÅÑ„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ", class: '', hint: 'ÊúÄÂæå„ÅÆÊñáÁ´†„Åå„Å™„Åã„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'Áúü„Çì‰∏≠„ÅÆÊñáÁ´†„Åå„Å™„Åã„Å£„Åü' },
            { desc: "Â£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'ÊúÄÂàù„ÅÆÊñáÁ´†„Åå„Å™„Åã„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ∫ä„ÅØÊø°„Çå„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'ÊñáÁ´†„ÅÆÂÜÖÂÆπ„Åå‰∏ÄÈÉ®ÈÅï„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Å™„ÅÑ„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„Äå„ÅÑ„Çã„Äç„Åå„Äå„ÅÑ„Å™„ÅÑ„Äç„Å´„Å™„Å£„Å¶„ÅÑ„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Åß„ÅØ„Å™„ÅÑ„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: 'ÊñáÁ´†„Åå‰∏ÄÈÉ®Âê¶ÂÆöÂΩ¢„Å†„Å£„Åü' },
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∫ï„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅÈü≥„ÇÇ„Å™„ÅèÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÈü≥„ÇÇ„Å™„Åè„Äç„Å®Êõ∏„Åã„Çå„Å¶„ÅÑ„Åü' },
            { desc: normalDescription + "\nËÉåÂæå„Å´Ê∞óÈÖç„Åå„Åô„Çã„ÄÇ", class: '', hint: 'ÊñáÊú´„Å´‰∏ÄÊñáËøΩÂä†„Åï„Çå„Å¶„ÅÑ„Åü' },

            // CSSÁï∞Â§â
            { desc: normalDescription, class: 'anomaly-title-weight', hint: 'ÈÄöË∑ØÁï™Âè∑„ÅÆÂ§™„Åï„ÅåÈÅï„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-light-red', hint: 'Â§©‰∫ï„ÅÆÁÖßÊòé„ÅåËµ§„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-light-flicker', hint: 'Â§©‰∫ï„ÅÆÁÖßÊòé„ÅåÁÇπÊªÖ„Åó„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-light-off', hint: 'Â§©‰∫ï„ÅÆÁÖßÊòé„ÅåÊ∂à„Åà„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-light-green', hint: 'Â§©‰∫ï„ÅÆÁÖßÊòé„ÅåÁ∑ëËâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-light-narrow', hint: 'Â§©‰∫ï„ÅÆÁÖßÊòé„ÅåÁ¥∞„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-font-creepy', hint: 'Ë™¨ÊòéÊñá„ÅÆ„Éï„Ç©„É≥„Éà„ÅåÈÅï„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-shake', hint: 'ÁîªÈù¢„ÅåÊè∫„Çå„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-text-color-strong', hint: 'Ë™¨ÊòéÊñá„ÅÆËâ≤„Åå„Éî„É≥„ÇØ„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-letter-spacing', hint: 'Ë™¨ÊòéÊñá„ÅÆÊñáÂ≠óÈñìÈöî„ÅåÂ∫É„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-title-color-strong', hint: 'ÈÄöË∑ØÁï™Âè∑„ÅÆËâ≤„Åå„Ç™„É¨„É≥„Ç∏„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-crooked', hint: 'Â£Å„ÅÆÊ°àÂÜÖÊùø„ÅåÂÇæ„ÅÑ„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-garbled', hint: 'Ê°àÂÜÖÊùø„ÅÆ„Éï„Ç©„É≥„Éà„ÅåÈÅï„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-shadow', hint: 'Ê°àÂÜÖÊùø„ÅÆÂΩ±„ÅåËµ§„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-blue', hint: 'Ê°àÂÜÖÊùø„ÅÆËâ≤„ÅåÈùí„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-missing', hint: 'Â£Å„ÅÆÊ°àÂÜÖÊùø„Åå„Å™„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-text-changed', hint: 'Ê°àÂÜÖÊùø„ÅÆÊñáÂ≠ó„Åå„ÄåÂÖ•Âè£„Äç„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-text-mirrored', hint: 'ÈùûÂ∏∏Âè£„ÅÆÊñáÂ≠ó„ÅåÈè°ÊñáÂ≠ó„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-dashed', hint: 'Ê°àÂÜÖÊùø„ÅÆÊû†Á∑ö„ÅåÁÇπÁ∑ö„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-text-yellow', hint: 'Ê°àÂÜÖÊùø„ÅÆÊñáÂ≠ó„ÅåÈªÑËâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-open', hint: 'ÈùûÂ∏∏Âè£„ÅÆ„Éâ„Ç¢„ÅåÈñã„ÅÑ„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-sign-peeking', hint: 'ÈùûÂ∏∏Âè£„ÅÆ‰∏ä„Åã„ÇâË™∞„Åã„ÅåË¶ã„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-text-align-justify', hint: 'Ë™¨ÊòéÊñá„Åå‰∏°Á´ØÊèÉ„Åà„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-border-radius', hint: 'ÂÖ®‰Ωì„ÅÆÊû†„Åå‰∏∏„Åæ„Å£„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-buttons-swapped', hint: 'ÈÄ≤„ÇÄ/Êàª„Çã„Éú„Çø„É≥„ÅÆ‰ΩçÁΩÆ„ÅåÈÄÜ„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-buttons-black-text', hint: '„Éú„Çø„É≥„ÅÆÊñáÂ≠ó„ÅåÈªí„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-puddle', hint: 'Â∫ä„Å´Ê∞¥„Åü„Åæ„Çä„Åå„ÅÇ„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-puddle-green', hint: 'Â∫ä„ÅÆÊ∞¥„Åü„Åæ„Çä„ÅåÁ∑ëËâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-crack', hint: 'Â£Å„Å´‰∫ÄË£Ç„Åå„ÅÇ„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-crack-red', hint: 'Â£Å„ÅÆ‰∫ÄË£Ç„ÅåËµ§„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-border-color-strong', hint: 'ÂÖ®‰Ωì„ÅÆÊû†Á∑ö„ÅÆËâ≤„ÅåÁ¥´„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-border-color-green', hint: 'ÂÖ®‰Ωì„ÅÆÊû†Á∑ö„ÅÆËâ≤„ÅåÁ∑ë„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-border-color-blue', hint: 'ÂÖ®‰Ωì„ÅÆÊû†Á∑ö„ÅÆËâ≤„ÅåÈùí„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-bg-strong', hint: 'ËÉåÊôØ„ÅÆËâ≤„ÅåÊøÉ„ÅÑÈùí„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-wrapper-bg-strong', hint: '„Ç≤„Éº„É†ÁîªÈù¢„ÅÆËÉåÊôØ„ÅåÊøÉ„ÅÑËµ§„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-floor-yellow', hint: 'Â∫ä„ÅÆÊ®°Êßò„ÅåÈªÑËâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-floor-red', hint: 'Â∫ä„ÅÆÊ®°Êßò„ÅåËµ§„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-floor-blue', hint: 'Â∫ä„ÅÆÊ®°Êßò„ÅåÈùí„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-upside-down', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„ÅåÈÄÜ„Åï„Åæ„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-text-garbled', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„ÅÆÊñáÂ≠ó„ÅåÂåñ„Åë„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-missing', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„Åå„Å™„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-text-changed', hint: '„Éù„Çπ„Çø„Éº„ÅÆÊñáÂ≠ó„Åå„ÄåÂç±Èô∫„Äç„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-text-mirrored', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„ÅÆÊñáÂ≠ó„ÅåÈè°ÊñáÂ≠ó„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-color-changed', hint: '„Éù„Çπ„Çø„Éº„ÅÆËâ≤„ÅåÊ∞¥Ëâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-bigger', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„ÅåÂ§ß„Åç„Åè„Å™„Å£„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-smaller', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„ÅåÂ∞è„Åï„Åè„Å™„Å£„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-poster-eye', hint: 'Â∑¶„ÅÆ„Éù„Çπ„Çø„Éº„Å´ÁõÆÁéâ„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-text-upside-down', hint: 'Ë™¨ÊòéÊñá„ÅåÈÄÜ„Åï„Åæ„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-text-mirrored', hint: 'Ë™¨ÊòéÊñá„ÅåÈè°ÊñáÂ≠ó„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-floor-angle-changed', hint: 'Â∫ä„ÅÆÊ®°Êßò„ÅÆËßíÂ∫¶„ÅåÈÅï„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-puddle-red', hint: 'Â∫ä„ÅÆÊ∞¥„Åü„Åæ„Çä„ÅåËµ§„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-title-shadow-green', hint: 'ÈÄöË∑ØÁï™Âè∑„ÅÆÂΩ±„ÅåÁ∑ë„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-buttons-glow', hint: '„Éú„Çø„É≥„ÅåÂÖâ„Å£„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-wrapper-rotated', hint: 'ÂÖ®‰Ωì„ÅåÂÉÖ„Åã„Å´ÂÇæ„ÅÑ„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-message-border', hint: '„É°„ÉÉ„Çª„Éº„Ç∏Ê¨Ñ„Å´Êû†„Åå„ÅÇ„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-buttons-square', hint: '„Éú„Çø„É≥„ÅåÂõõËßí„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-body-grayscale', hint: 'ÂÖ®‰Ωì„ÅåÁôΩÈªí„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-body-sepia', hint: 'ÂÖ®‰Ωì„Åå„Çª„Éî„Ç¢Ëâ≤„Å†„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-body-invert', hint: 'ÂÖ®‰Ωì„ÅÆËâ≤„ÅåÂèçËª¢„Åó„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-body-hue-rotate', hint: 'ÂÖ®‰Ωì„ÅÆËâ≤Áõ∏„ÅåÂõûËª¢„Åó„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-body-blur', hint: 'ÂÖ®‰Ωì„Åå„Åº„ÇÑ„Åë„Å¶„ÅÑ„Åü' },
            { desc: normalDescription, class: 'anomaly-body-contrast', hint: 'ÂÖ®‰Ωì„ÅÆ„Ç≥„É≥„Éà„É©„Çπ„Éà„ÅåÈ´ò„Åã„Å£„Åü' },
            { desc: normalDescription, class: 'anomaly-body-silhouette', hint: 'ËÉåÊôØ„Å´‰∫∫ÂΩ±„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„Åü' },

            // --- Added anomalies (request) ---
            // 1. „ÄåÂ§©‰∫ï„Äç„Åå„ÄåÂ§©‰∏º„Äç
            { desc: "„ÅÇ„Å™„Åü„ÅØÁ∞°Á¥†„Å™ÈÄöË∑Ø„Å´„ÅÑ„Çã„ÄÇ\nÂ£Å„ÅØ„Ç≥„É≥„ÇØ„É™„Éº„ÉàÊâì„Å°„Å£„Å±„Å™„Åó„Å†„ÄÇ\nÂ§©‰∏º„ÅÆËõçÂÖâÁÅØ„Åå„ÄÅ„Ç∏„Éº‚Ä¶„Å®„ÅÑ„ÅÜÈü≥„ÇíÁ´ã„Å¶„Å¶ÁôΩ„ÅèÂÖâ„Å£„Å¶„ÅÑ„Çã„ÄÇ", class: '', hint: '„ÄåÂ§©‰∫ï„Äç„Åå„ÄåÂ§©‰∏º„Äç„Å†„Å£„Åü' },
            // 2. ÈÄ≤„ÇÄ->ÈÄ≤„ÇÅ
            { desc: normalDescription, class: 'anomaly-forward-imperative', hint: '„Éú„Çø„É≥„ÅÆ„ÄåÈÄ≤„ÇÄ„Äç„Åå„ÄåÈÄ≤„ÇÅ„Äç„Å†„Å£„Åü' },
            // 3. Êàª„Çã->Êàª„Çå
            { desc: normalDescription, class: 'anomaly-back-imperative', hint: '„Éú„Çø„É≥„ÅÆ„ÄåÊàª„Çã„Äç„Åå„ÄåÊàª„Çå„Äç„Å†„Å£„Åü' },
            // 4. Âè≥‰∏ã„Å´„Éë„É≥„ÉÜ„Ç£„Éº
            { desc: normalDescription, class: 'anomaly-panties-br', hint: 'Âè≥‰∏ã„Å´„Éë„É≥„ÉÜ„Ç£„Éº„ÅåËêΩ„Å°„Å¶„ÅÑ„Åü' },
            // 5. Â∑¶‰∏ã„Å´„Éà„É©„É≥„ÇØ„Çπ
            { desc: normalDescription, class: 'anomaly-trunks-bl', hint: 'Â∑¶‰∏ã„Å´„Éà„É©„É≥„ÇØ„Çπ„ÅåËêΩ„Å°„Å¶„ÅÑ„Åü' },
            // 6. ÂÆâÂÖ®Á¨¨‰∏Ä‚ÜíÂÆâÂÖ®Âºü‰∏Ä
            { desc: normalDescription, class: 'anomaly-poster-safety-brother', hint: '„Éù„Çπ„Çø„Éº„ÅÆ„ÄåÂÆâÂÖ®Á¨¨‰∏Ä„Äç„Åå„ÄåÂÆâÂÖ®Âºü‰∏Ä„Äç„Å†„Å£„Åü' },
            // 8. ÈùûÂ∏∏Âè£„ÅåÈ´ò„ÅÑ
            { desc: normalDescription, class: 'anomaly-sign-higher', hint: 'ÈùûÂ∏∏Âè£„ÅÆ‰ΩçÁΩÆ„ÅåÂ∞ë„ÅóÈ´ò„Åã„Å£„Åü' },
            // 8b. ÈùûÂ∏∏Âè£„Åå‰Ωé„ÅÑ
            { desc: normalDescription, class: 'anomaly-sign-lower', hint: 'ÈùûÂ∏∏Âè£„ÅÆ‰ΩçÁΩÆ„ÅåÂ∞ë„Åó‰Ωé„Åã„Å£„Åü' },
            // 9. „Éù„Çπ„Çø„Éº„ÅåÈ´ò„ÅÑ
            { desc: normalDescription, class: 'anomaly-poster-higher', hint: '„Éù„Çπ„Çø„Éº„ÅÆ‰ΩçÁΩÆ„ÅåÂ∞ë„ÅóÈ´ò„Åã„Å£„Åü' },
            // 9b. „Éù„Çπ„Çø„Éº„Åå‰Ωé„ÅÑ
            { desc: normalDescription, class: 'anomaly-poster-lower', hint: '„Éù„Çπ„Çø„Éº„ÅÆ‰ΩçÁΩÆ„ÅåÂ∞ë„Åó‰Ωé„Åã„Å£„Åü' },
            // 10. „Äå„ÄúÁï™ÈÄöË∑Ø„Äç„ÅÆË°®Á§∫‰ΩçÁΩÆ„ÅåÂ∞ë„Åó‰Ωé„ÅÑ
            { desc: normalDescription, class: 'anomaly-passage-title-lower', hint: '„Äå„ÄúÁï™ÈÄöË∑Ø„Äç„ÅÆË°®Á§∫‰ΩçÁΩÆ„ÅåÂ∞ë„Åó‰Ωé„Åã„Å£„Åü' },
            // 11. Â§©‰∫ï„É©„Ç§„Éà„ÅÆ„Éñ„É©„ÉºÂäπÊûú„ÅåÂ∞ë„ÅóÂ§ß„Åç„ÅÑ
            { desc: normalDescription, class: 'anomaly-light-blur-stronger', hint: 'Â§©‰∫ï„É©„Ç§„Éà„ÅÆÂÖâÁ∑ö„ÅåÂº∑„Åã„Å£„Åü' },
            // 12. „Ç´„Éº„ÇΩ„É´„ÇíËøë„Å•„Åë„Çã„Å®„Éú„Çø„É≥„ÅåÈÄÉ„Åí„Çã
            { desc: normalDescription, class: 'anomaly-buttons-avoid-cursor', hint: '„Ç´„Éº„ÇΩ„É´„Å´ÂèçÁô∫„Åó„Å¶„Éú„Çø„É≥„ÅåÂ∞ë„ÅóÈÄÉ„Åí„Åü' },
            // 13. „Ç´„Éº„ÇΩ„É´„ÅÆËâ≤„ÅåËñÑ„Åè„Å™„Çã
            { desc: normalDescription, class: 'anomaly-cursor-faint', hint: '„Ç´„Éº„ÇΩ„É´„ÅÆËâ≤„ÅåËñÑ„Åè„Å™„Å£„Å¶„ÅÑ„Åü' },
            // 14. ÁîªÈù¢Â§ñ„Å´„Ç´„Éº„ÇΩ„É´„ÅßÊöó„Åè„Å™„Çã
            { desc: normalDescription, class: 'anomaly-dim-on-leave', hint: '„Ç≤„Éº„É†ÁîªÈù¢Â§ñ„Å´„Ç´„Éº„ÇΩ„É´„ÅßÁîªÈù¢„ÅåÊöó„Åè„Å™„Å£„Åü' },
            // 15. „Ç´„Éº„ÇΩ„É´ÁßªÂãï„ÅßËñÑ„ÅÑËªåË∑°„ÅåÊÆã„Çã
            { desc: normalDescription, class: 'anomaly-cursor-trail', hint: '„Ç´„Éº„ÇΩ„É´„ÅÆÁßªÂãï„Å´ËñÑ„ÅÑËªåË∑°„ÅåÊÆã„Å£„Åü' },
            // 16. URLË°®Á§∫Ê¨Ñ„Å´„Äå„Åå„Çì„Å∞„Çå„Éº„Äç
            { desc: normalDescription, class: 'anomaly-url-ganbare', hint: 'URL„ÅÆË°®Á§∫Ê¨Ñ„Å´„Äå„Åå„Çì„Å∞„Çå„Éº„Äç„Å®Ë°®Á§∫„Åï„Çå„Åü' },
            // 17. „Éñ„É©„Ç¶„Ç∂Â∑¶‰∏ä„Å´„Éè„Éº„Éà
            { desc: normalDescription, class: 'anomaly-body-heart-topleft', hint: '„Éñ„É©„Ç¶„Ç∂„ÅÆÂ∑¶‰∏ä„Å´„Éè„Éº„Éà„ÅåË°®Á§∫„Åï„Çå„Åü' }
        ];

        // Use crypto-backed randomness to avoid repetitive patterns across reloads
        function randomFloat() {
            try {
                if (window.crypto && window.crypto.getRandomValues) {
                    const u32 = new Uint32Array(1);
                    window.crypto.getRandomValues(u32);
                    // 0 <= x < 1
                    return u32[0] / 4294967296; // 2^32
                }
            } catch (_) { /* fallback below */ }
            return Math.random();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(randomFloat() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function getNextAnomaly() {
            if (shuffledAnomalies.length === 0) {
                shuffledAnomalies = [...anomalies];
                shuffleArray(shuffledAnomalies);
            }
            return shuffledAnomalies.pop();
        }

        // NOTE: Debug UI is initialized in initDebugMode() to avoid duplication.

        function initDebugMode() {
            if (isDebugEnabledFromURL()) {
                isDebugMode = true;
                debugInfo.style.display = 'block';
                debugInfo.classList.add('active');

                console.log('Initializing debug mode...');

                // „Éá„Éê„ÉÉ„Ç∞„É¢„Éº„ÉâÁî®„Å´ÂÖÉ„ÅÆÈÖçÂàó„Çí„Ç≥„Éî„Éº„Åó„Å¶‰øùÂ≠ò
                originalAnomalies = JSON.parse(JSON.stringify(anomalies));

                // „Åô„Åß„Å´ÂàùÊúüÂåñÊ∏à„Åø„Å™„ÇâÂÜçÂàùÊúüÂåñ„ÇíÈÅø„Åë„Çã
                if (debugInfo.querySelector('#anomaly-selector')) {
                    updateDebugInfo();
                    return;
                }

                const selector = document.createElement('select');
                selector.id = 'anomaly-selector';
                selector.innerHTML = '<option value="-1">Áï∞Â§â„Å™„Åó</option>';
                // ÈÅ∏Êäû„Åó„ÅüÊôÇÁÇπ„ÅßÂç≥ÈÅ©Áî®
                selector.addEventListener('change', () => {
                    const selectedIndex = parseInt(selector.value, 10);
                    forceSetAnomaly(selectedIndex);
                });

                // ÂÖÉ„ÅÆÈÖçÂàó„Çí„ÇΩ„Éº„ÉàÁî®„Å´Ê∫ñÂÇô
                const anomaliesWithIndex = originalAnomalies.map((anomaly, index) => ({
                    hint: anomaly.hint,
                    originalIndex: index,
                    anomaly: anomaly
                }));

                console.log('Total anomalies before sort:', anomaliesWithIndex.length);

                // „Éí„É≥„Éà„ÅÆÂÜÖÂÆπ„Åß„ÇΩ„Éº„Éà
                anomaliesWithIndex.sort((a, b) => a.hint.localeCompare(b.hint, 'ja'));

                // optionË¶ÅÁ¥†„Çí‰ΩúÊàê
                anomaliesWithIndex.forEach((item, sortedIndex) => {
                    const option = document.createElement('option');
                    option.value = item.originalIndex;
                    option.textContent = `[${item.originalIndex}] ${item.hint}`;
                    selector.appendChild(option);
                });

                // ËÑ±Âá∫ÊàêÂäü„Çπ„ÇØ„É™„Éº„É≥Ë°®Á§∫„Éú„Çø„É≥
                const successBtn = document.createElement('button');
                successBtn.id = 'show-success-btn';
                successBtn.textContent = 'ËÑ±Âá∫ÊàêÂäü„ÇíË°®Á§∫';
                successBtn.onclick = () => {
                    currentPassage = 8;
                    hasAnomaly = false;
                    clearGame();
                    fadeOverlay.classList.remove('is-active');
                };

                debugInfo.innerHTML = '<h3>--- DEBUG MODE ---</h3><p>Loading...</p>';
                debugInfo.appendChild(selector);
                debugInfo.appendChild(successBtn);

                console.log('Debug mode initialized');
            }
        }

        function updateDebugInfo() {
            if (!isDebugMode) return;

            const successMessage = wrapper.querySelector('.success-message');
            if (successMessage) {
                debugInfo.innerHTML = `
                <h3>--- DEBUG MODE ---</h3>
                <b>GAME STATE:</b> CLEARED<br>
                <b>Final Passage:</b> ${currentPassage}
            `;
                return;
            }

            const hintText = hasAnomaly ? currentAnomaly.hint : '„Å™„Åó';
            const debugContent = `
            <h3>--- DEBUG MODE ---</h3>
            <b>Passage:</b> ${currentPassage}<br>
            <b>Anomaly Active:</b> ${hasAnomaly}<br>
            <b>Description:</b> ${hintText}<br>
            <b>Class:</b> ${currentAnomaly.class || '„Å™„Åó'}
        `;

            const selector = debugInfo.querySelector('#anomaly-selector');
            const successBtn = debugInfo.querySelector('#show-success-btn');
            debugInfo.innerHTML = debugContent;
            if (selector) debugInfo.appendChild(selector);
            if (successBtn) debugInfo.appendChild(successBtn);
        }

        function resetVisuals() {
            // Áï∞Â§â„ÅÆËß£Èô§ÊôÇ„Å´„Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥„ÅßÂãï„Åç„ÅåÂá∫„Å™„ÅÑ„Çà„ÅÜ‰∏ÄÊôÇÁöÑ„Å´ÊäëÊ≠¢
            wrapper.classList.add('no-transition');
            bodyEl.classList.add('no-transition-filter');
            if (currentAnomaly.class) {
                wrapper.classList.remove(currentAnomaly.class);
                bodyEl.classList.remove(currentAnomaly.class);
            }

            description.style.color = '';
            passageTitle.style.color = '';
            wrapper.style.borderColor = '';
            wrapper.style.backgroundColor = '';
            wrapper.style.transform = '';
            wrapper.style.boxShadow = '';
            bodyEl.style.backgroundColor = '';
            bodyEl.style.filter = '';
            forwardButton.style.color = '';
            backButton.style.color = '';
            message.style.border = '';
            // reset button drift (for avoid-cursor anomaly)
            avoidCursorActive = false;
            resetButtonTransforms();
            // reset dim-on-leave state
            dimOnLeaveActive = false;
            wrapper.classList.remove('is-dimmed');
            // reset cursor trail
            cursorTrailActive = false;
            wrapper.querySelectorAll('.cursor-trail-dot').forEach(el => el.remove());
            // reset URL bar text if we changed it
            if (urlGanbareActive) {
                history.replaceState(null, '', location.pathname + location.search + originalURLHash);
                urlGanbareActive = false;
            }
            // Ê¨°„Éï„É¨„Éº„É†„ÅßÊäëÊ≠¢„Éï„É©„Ç∞„ÇíËß£Èô§
            requestAnimationFrame(() => {
                // reflow „ÇíÊåü„Çì„ÅßÁ¢∫ÂÆü„Å´„Çπ„Çø„Ç§„É´„ÇíÁ¢∫ÂÆö
                void wrapper.offsetHeight;
                wrapper.classList.remove('no-transition');
                bodyEl.classList.remove('no-transition-filter');
            });
        }

        function applyAnomaly(anomaly) {
            currentAnomaly = anomaly;
            description.innerHTML = currentAnomaly.desc;
            // Áï∞Â§â„ÅÆÈÅ©Áî®ÊôÇ„ÇÇ„Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥„ÅßÂãï„Åç„ÅåÂá∫„Å™„ÅÑ„Çà„ÅÜ‰∏ÄÊôÇÁöÑ„Å´ÊäëÊ≠¢
            wrapper.classList.add('no-transition');
            bodyEl.classList.add('no-transition-filter');
            if (currentAnomaly.class) {
                if (currentAnomaly.class.startsWith('anomaly-body-')) {
                    bodyEl.classList.add(currentAnomaly.class);
                } else {
                    wrapper.classList.add(currentAnomaly.class);
                }
            }
            // Enable/disable cursor-avoid behavior dynamically
            avoidCursorActive = currentAnomaly.class === 'anomaly-buttons-avoid-cursor';
            if (!avoidCursorActive) resetButtonTransforms();
            // Enable dim-on-leave behavior dynamically
            dimOnLeaveActive = currentAnomaly.class === 'anomaly-dim-on-leave';
            if (!dimOnLeaveActive) wrapper.classList.remove('is-dimmed');
            // Enable cursor trail behavior dynamically
            cursorTrailActive = currentAnomaly.class === 'anomaly-cursor-trail';
            if (!cursorTrailActive) wrapper.querySelectorAll('.cursor-trail-dot').forEach(el => el.remove());
            // Enable URL bar change dynamically (use hash to avoid navigation)
            if (currentAnomaly.class === 'anomaly-url-ganbare') {
                urlGanbareActive = true;
                history.replaceState(null, '', location.pathname + location.search + '#„Åå„Çì„Å∞„Çå„Éº');
            } else if (urlGanbareActive) {
                history.replaceState(null, '', location.pathname + location.search + originalURLHash);
                urlGanbareActive = false;
            }
            // Ê¨°„Éï„É¨„Éº„É†„ÅßÊäëÊ≠¢„Éï„É©„Ç∞„ÇíËß£Èô§Ôºà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Á≥ª„ÅÆÁï∞Â§â„ÅØCSS„ÅÆanimation„ÅßÂãï„Åè„Åü„ÇÅÂΩ±Èüø„Å™„ÅóÔºâ
            requestAnimationFrame(() => {
                void wrapper.offsetHeight;
                wrapper.classList.remove('no-transition');
                bodyEl.classList.remove('no-transition-filter');
            });
        }

        function forceSetAnomaly(index) {
            resetVisuals();
            if (index === -1) {
                hasAnomaly = false;
                currentAnomaly = {};
                description.innerHTML = normalDescription;
            } else {
                hasAnomaly = true;
                const anomaly = anomalies[index];
                applyAnomaly(anomaly);
            }
            updateDebugInfo();
        }

        function setupNewPassage() {
            passageTitle.textContent = `${currentPassage >= 8 ? 8 : currentPassage}Áï™ÈÄöË∑Ø`;

            resetVisuals();

            currentAnomaly = {};
            // Clear transient message so '...' does not remain when nothing to show
            message.textContent = '';

            if (isFirstTurn) {
                hasAnomaly = false;
                isFirstTurn = false;
            } else if (randomFloat() < 0.70) {
                hasAnomaly = true;
            } else {
                hasAnomaly = false;
            }

            if (hasAnomaly) {
                applyAnomaly(getNextAnomaly());
            } else {
                description.innerHTML = normalDescription;
            }
            updateDebugInfo();

            // In normal mode, if a pending message exists when returning to 0, show the cause.
            if (!isHardMode && currentPassage === 0 && pendingReturnMessage) {
                message.textContent = pendingReturnMessage;
                pendingReturnMessage = '';
            }

            // In soft mode, after a correct detection on previous turn, show the anomaly content
            if (isSoftMode && currentPassage > 0 && pendingProceedMessage) {
                message.textContent = pendingProceedMessage;
                pendingProceedMessage = '';
            }
        }

        function processTurn(decision) {
            if (currentPassage >= 8 && !hasAnomaly && decision === false) {
                forwardButton.disabled = true;
                backButton.disabled = true;
                fadeOverlay.classList.add('is-active');
                setTimeout(() => {
                    clearGame();
                    // Reveal the success screen after fade
                    fadeOverlay.classList.remove('is-active');
                }, 1000);
                return;
            }

            const isCorrect = decision === hasAnomaly;

            forwardButton.disabled = true;
            backButton.disabled = true;
            fadeOverlay.classList.add('is-active');

            setTimeout(() => {
                if (isCorrect) {
                    // In soft mode, if an anomaly was correctly detected, carry over its content
                    if (isSoftMode && hasAnomaly && currentAnomaly && currentAnomaly.hint) {
                        pendingProceedMessage = `Áï∞Â§â: ${currentAnomaly.hint}`;
                    }
                    message.textContent = '...';
                    if (currentPassage < 8) {
                        currentPassage++;
                    }
                } else {
                    const msg = hasAnomaly
                        ? `Áï∞Â§â„ÇíË¶ãÈÄÉ„Åó„Åæ„Åó„Åü„ÄÇ(ÂÜÖÂÆπ: ${currentAnomaly.hint})`
                        : "Áï∞Â§â„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ";
                    // In hard mode, show nothing when returning to 0.
                    // In normal mode, defer the cause message to display on the 0 passage.
                    pendingReturnMessage = isHardMode ? '' : `${msg} 0Áï™ÈÄöË∑Ø„Å´Êàª„Çä„Åæ„Åô„ÄÇ`;
                    currentPassage = 0;
                    isFirstTurn = true;
                    shuffledAnomalies = [];
                }

                setupNewPassage();

                fadeOverlay.classList.remove('is-active');

                setTimeout(() => {
                    const successMessage = wrapper.querySelector('.success-message');
                    if (!successMessage) {
                        forwardButton.disabled = false;
                        backButton.disabled = false;
                    }
                }, 1000);

            }, 1000);
        }

        function clearGame() {
            wrapper.innerHTML = `
            <div class="exit-container">
                <div class="exit-light"></div>
                <div class="exit-floor"></div>
                <div class="stairs">
                    <div class="step"></div>
                    <div class="step"></div>
                    <div class="step"></div>
                    <div class="step"></div>
                    <div class="step"></div>
                </div>
                <div class="success-message">ËÑ±Âá∫ÊàêÂäüÔºÅ</div>
            </div>
            <style>
                .exit-container {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: flex-end;
                    height: 300px;
                    position: relative;
                    background: radial-gradient(circle at 50% -40px, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.6) 55%, rgba(0,0,0,0.85) 100%);
                    overflow: hidden;
                }
                .exit-container::before{
                    content: '';
                    position: absolute;
                    inset: -60px;
                    background: radial-gradient(circle at 50% -40px, rgba(0,0,0,0) 28%, rgba(0,0,0,0.55) 62%, rgba(0,0,0,0.9) 95%);
                    z-index: 2; /* darken surroundings */
                    pointer-events: none;
                }
                .exit-light {
                    position: absolute;
                    top: -50px;
                    width: 400%;
                    height: 260px;
                    background:
                        radial-gradient(circle at 50% 10%, rgba(255,255,255,1) 0%, rgba(255,255,255,0.85) 14%, rgba(255,255,180,0.7) 26%, rgba(255,255,200,0.25) 46%, rgba(255,255,220,0.05) 70%, rgba(255,255,220,0) 80%),
                        radial-gradient(circle at 50% 10%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 35%);
                    filter: blur(6px) brightness(1.25);
                    animation: glowPulse 2.2s ease-in-out infinite;
                    z-index: 1; /* behind overlay */
                }
                /* Foreground floor plane */
                .exit-floor {
                    position: absolute;
                    left: 50%;
                    bottom: -10px;
                    transform: translateX(-50%) perspective(700px) rotateX(58deg);
                    width: 320%;
                    height: 160px;
                    background:
                        linear-gradient(to bottom, rgba(255,255,255,0.95), rgba(238,238,238,0.9)),
                        repeating-linear-gradient(45deg, rgba(245,245,245,0.9) 0px, rgba(245,245,245,0.9) 10px, rgba(232,232,232,0.9) 10px, rgba(232,232,232,0.9) 20px);
                    box-shadow: 0 -8px 30px rgba(255,255,220,0.6) inset, 0 0 30px rgba(255,255,200,0.25);
                    z-index: 3; /* same layer as stairs, will render under by DOM order */
                }
                .stairs {
                    width: 150px;
                    height: 150px;
                    position: relative;
                    perspective: 400px;
                    z-index: 3; /* above vignette */
                    overflow: visible;
                }
                /* Soft glow spilling onto the steps */
                .stairs::before {
                    content: '';
                    position: absolute;
                    left: 50%;
                    top: -10px;
                    transform: translateX(-50%);
                    width: 200%;
                    height: 180%;
                    background: radial-gradient(ellipse at 50% -20px,
                        rgba(255,255,240,0.85) 0%,
                        rgba(255,255,210,0.55) 25%,
                        rgba(255,255,190,0.25) 48%,
                        rgba(255,255,180,0) 70%);
                    filter: blur(10px);
                    pointer-events: none;
                    z-index: 4;
                }
                /* Light rays across the stairs */
                .stairs::after {
                    content: '';
                    position: absolute;
                    left: 50%;
                    top: -20px;
                    transform: translateX(-50%) rotate(-8deg);
                    width: 260%;
                    height: 200%;
                    background:
                        repeating-linear-gradient(
                            to bottom,
                            rgba(255,255,220,0.35) 0px,
                            rgba(255,255,220,0.35) 6px,
                            rgba(255,255,220,0.0) 22px,
                            rgba(255,255,220,0.0) 32px
                        );
                    opacity: 0.8;
                    filter: blur(8px);
                    pointer-events: none;
                    z-index: 4;
                }
                .step {
                    position: absolute;
                    bottom: 0;
                    left: 0;
                    width: 100%;
                    height: 30px;
                    background: #f0f0f0;
                    border-top: 2px solid #ffffff;
                    transform-origin: bottom center;
                    box-shadow: inset 0 8px 18px rgba(255,255,240,0.25);
                }
                .step:nth-child(1) { transform: translateZ(0px) translateY(0px); }
                .step:nth-child(2) { transform: translateZ(-30px) translateY(-30px); }
                .step:nth-child(3) { transform: translateZ(-60px) translateY(-60px); }
                .step:nth-child(4) { transform: translateZ(-90px) translateY(-90px); }
                .step:nth-child(5) { transform: translateZ(-120px) translateY(-120px); }
                .success-message {
                    margin-top: 20px;
                    color: #ffffff;
                    font-size: 2.2em;
                    font-weight: 700;
                    -webkit-text-stroke: 1px rgba(0,0,0,0.55);
                    text-shadow:
                        0 1px 2px rgba(0,0,0,0.85),
                        0 2px 6px rgba(0,0,0,0.6),
                        0 0 8px rgba(255,255,200,0.85),
                        0 0 18px rgba(255,255,140,0.55);
                    animation: pulse 1.5s infinite alternate;
                    z-index: 5;
                }
                @keyframes pulse{from{transform:scale(1)}to{transform:scale(1.05)}}
                @keyframes glowPulse{0%{filter: blur(6px) brightness(1.15)}50%{filter: blur(7px) brightness(1.35)}100%{filter: blur(6px) brightness(1.15)}}
            </style>
        `;
            updateDebugInfo();
        }

        forwardButton.addEventListener('click', () => { processTurn(false); });
        backButton.addEventListener('click', () => { processTurn(true); });

        initDebugMode();
        // Initialize hard/soft mode from URL
        isHardMode = isHardModeEnabledFromURL();
        isSoftMode = isSoftModeEnabledFromURL();
        // NOTE: Do not shuffle the master `anomalies` array.
        // Random selection uses `shuffledAnomalies` built from a copy in getNextAnomaly().
        // Shuffling here breaks debug dropdown indices.
        setupNewPassage();
    </script>

</body>

</html>
